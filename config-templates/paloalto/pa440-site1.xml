<?xml version="1.0"?>
<config version="10.1.0" urldb="paloaltonetworks">
  <devices>
    <entry name="localhost.localdomain">
      <!-- Network Configuration -->
      <network>
        <interface>
          <ethernet>
            <entry name="ethernet1/1">
              <layer3>
                <ipv4>
                  <entry name="[WAN_IP]/[SUBNET]"/>
                </ipv4>
                <interface-management-profile>ping-only</interface-management-profile>
              </layer3>
            </entry>
            <entry name="ethernet1/2">
              <layer3>
                <ipv4>
                  <entry name="10.83.10.1/24"/>
                </ipv4>
                <interface-management-profile>ping-only</interface-management-profile>
              </layer3>
            </entry>
            <entry name="ethernet1/3">
              <layer3>
                <ipv4>
                  <entry name="10.83.10.2/24"/>
                </ipv4>
                <interface-management-profile>ping-only</interface-management-profile>
              </layer3>
            </entry>
          </ethernet>
        </interface>
        <virtual-router>
          <entry name="default">
            <routing-table>
              <ip>
                <static-route>
                  <entry name="default">
                    <nexthop>
                      <ip-address>[GATEWAY_IP]</ip-address>
                    </nexthop>
                    <interface>ethernet1/1</interface>
                    <destination>0.0.0.0/0</destination>
                  </entry>
                  <entry name="hq-network">
                    <nexthop>
                      <ip-address>10.83.10.254</ip-address>
                    </nexthop>
                    <interface>ethernet1/2</interface>
                    <destination>10.83.40.0/24</destination>
                  </entry>
                  <entry name="site2-network">
                    <nexthop>
                      <ip-address>10.83.10.254</ip-address>
                    </nexthop>
                    <interface>ethernet1/2</interface>
                    <destination>10.83.20.0/24</destination>
                  </entry>
                  <entry name="site3-network">
                    <nexthop>
                      <ip-address>10.83.10.254</ip-address>
                    </nexthop>
                    <interface>ethernet1/2</interface>
                    <destination>10.83.30.0/24</destination>
                  </entry>
                </static-route>
              </ip>
            </routing-table>
          </entry>
        </virtual-router>
        <zone>
          <entry name="WAN">
            <network>
              <layer3>
                <member>ethernet1/1</member>
              </layer3>
            </network>
          </entry>
          <entry name="LAN">
            <network>
              <layer3>
                <member>ethernet1/2</member>
              </layer3>
            </network>
          </entry>
          <entry name="DMZ">
            <network>
              <layer3>
                <member>ethernet1/3</member>
              </layer3>
            </network>
          </entry>
        </zone>
      </network>

      <!-- Security Policies -->
      <policies>
        <security>
          <rules>
            <entry name="Allow-Internal-to-WAN">
              <from>
                <member>LAN</member>
              </from>
              <to>
                <member>WAN</member>
              </to>
              <source>
                <member>10.83.10.0/24</member>
              </source>
              <destination>
                <member>any</member>
              </destination>
              <service>
                <member>any</member>
              </service>
              <application>
                <member>any</member>
              </application>
              <action>allow</action>
              <log-setting>default</log-setting>
            </entry>
            <entry name="Allow-WireGuard">
              <from>
                <member>WAN</member>
              </from>
              <to>
                <member>DMZ</member>
              </to>
              <source>
                <member>any</member>
              </source>
              <destination>
                <member>10.83.10.254</member>
              </destination>
              <service>
                <member>service-udp-51820</member>
              </service>
              <application>
                <member>any</member>
              </application>
              <action>allow</action>
              <log-setting>default</log-setting>
            </entry>
            <entry name="Allow-Internal-to-WireGuard">
              <from>
                <member>LAN</member>
              </from>
              <to>
                <member>DMZ</member>
              </to>
              <source>
                <member>10.83.10.0/24</member>
              </source>
              <destination>
                <member>10.83.10.254</member>
              </destination>
              <service>
                <member>any</member>
              </service>
              <application>
                <member>any</member>
              </application>
              <action>allow</action>
              <log-setting>default</log-setting>
            </entry>
          </rules>
        </security>
        <nat>
          <rules>
            <entry name="WAN-Outbound">
              <source-translation>
                <dynamic-ip-and-port>
                  <interface-address>
                    <interface>ethernet1/1</interface>
                  </interface-address>
                </dynamic-ip-and-port>
              </source-translation>
              <from>
                <member>LAN</member>
                <member>DMZ</member>
              </from>
              <to>
                <member>WAN</member>
              </to>
              <source>
                <member>10.83.10.0/24</member>
              </source>
              <destination>
                <member>any</member>
              </destination>
              <service>any</service>
            </entry>
            <entry name="WireGuard-Inbound">
              <destination-translation>
                <static-translation>
                  <translated-address>10.83.10.254</translated-address>
                </static-translation>
              </destination-translation>
              <from>
                <member>WAN</member>
              </from>
              <to>
                <member>DMZ</member>
              </to>
              <source>
                <member>any</member>
              </source>
              <destination>
                <member>[WAN_IP]</member>
              </destination>
              <service>service-udp-51820</service>
            </entry>
          </rules>
        </nat>
      </policies>

      <!-- Service Objects -->
      <service>
        <entry name="service-udp-51820">
          <protocol>
            <udp>
              <port>51820</port>
            </udp>
          </protocol>
        </entry>
      </service>
    </entry>
  </devices>
</config>
